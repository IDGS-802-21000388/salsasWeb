<div class="container mx-auto p-4" [ngClass]="{ 'blur-background': isModalOpen }">
    <div class="flex justify-between items-center mb-4">
      <h1 class="text-2xl font-semibold">Materias Primas</h1>
      <button mat-raised-button color="primary" (click)="createMateriaPrima()">
        Crear Materia Prima
      </button>
    </div>
    <div class="flex justify-between items-center mb-4">
      <div class="custom-input-container flex items-center border border-gray-300 rounded-md p-1">
        <ion-icon class="text-gray-500 ml-2 size-5" name="search-outline"></ion-icon>
        <input
          type="text"
          class="ml-2 flex-grow p-1 outline-none"
          placeholder="Buscar..."
          (input)="applyFilter($event)"
        />
      </div>
    </div>
    <div class="shadow-md rounded-lg overflow-hidden">
      <table mat-table [dataSource]="dataSource" class="min-w-full divide-y divide-gray-200">
        <!-- Table Header -->
        <ng-container matColumnDef="nombreMateria">
          <th mat-header-cell *matHeaderCellDef class="px-6 py-3 text-center text-xs font-medium text-gray-500 uppercase tracking-wider">
            Nombre
          </th>
          <td mat-cell *matCellDef="let materia" class="px-6 py-4 whitespace-nowrap text-center">
            {{ materia.nombreMateria }}
          </td>
        </ng-container>
  
        <ng-container matColumnDef="precioCompra">
          <th mat-header-cell *matHeaderCellDef class="px-6 py-3 text-center text-xs font-medium text-gray-500 uppercase tracking-wider">
            Precio Compra
          </th>
          <td mat-cell *matCellDef="let materia" class="px-6 py-4 whitespace-nowrap text-center">
            {{ materia.precioCompra }}
          </td>
        </ng-container>
  
        <ng-container matColumnDef="cantidad">
          <th mat-header-cell *matHeaderCellDef class="px-6 py-3 text-center text-xs font-medium text-gray-500 uppercase tracking-wider">
            Cantidad
          </th>
          <td mat-cell *matCellDef="let materia" class="px-6 py-4 whitespace-nowrap text-center">
            {{ materia.cantidad }}
          </td>
        </ng-container>
  
        <ng-container matColumnDef="idMedida">
          <th mat-header-cell *matHeaderCellDef class="px-6 py-3 text-center text-xs font-medium text-gray-500 uppercase tracking-wider">
            Medida
          </th>
          <td mat-cell *matCellDef="let materia" class="px-6 py-4 whitespace-nowrap text-center">
            {{ materia.idMedida }}
          </td>
        </ng-container>
  
        <ng-container matColumnDef="idProveedor">
          <th mat-header-cell *matHeaderCellDef class="px-6 py-3 text-center text-xs font-medium text-gray-500 uppercase tracking-wider">
            Proveedor
          </th>
          <td mat-cell *matCellDef="let materia" class="px-6 py-4 whitespace-nowrap text-center">
            {{ materia.idProveedor }}
          </td>
        </ng-container>
  
        <ng-container matColumnDef="fechaCompra">
          <th mat-header-cell *matHeaderCellDef class="px-6 py-3 text-center text-xs font-medium text-gray-500 uppercase tracking-wider">
            Fecha Compra
          </th>
          <td mat-cell *matCellDef="let detalle" class="px-6 py-4 whitespace-nowrap text-center">
            {{ detalle.fechaCompra | date }}
          </td>
        </ng-container>
  
        <ng-container matColumnDef="fechaVencimiento">
          <th mat-header-cell *matHeaderCellDef class="px-6 py-3 text-center text-xs font-medium text-gray-500 uppercase tracking-wider">
            Fecha Vencimiento
          </th>
          <td mat-cell *matCellDef="let detalle" class="px-6 py-4 whitespace-nowrap text-center">
            {{ detalle.fechaVencimiento | date }}
          </td>
        </ng-container>
  
        <ng-container matColumnDef="cantidadExistentes">
          <th mat-header-cell *matHeaderCellDef class="px-6 py-3 text-center text-xs font-medium text-gray-500 uppercase tracking-wider">
            Cantidad Existentes
          </th>
          <td mat-cell *matCellDef="let detalle" class="px-6 py-4 whitespace-nowrap text-center">
            {{ detalle.cantidadExistentes }}
          </td>
        </ng-container>
  
        <ng-container matColumnDef="porcentaje">
          <th mat-header-cell *matHeaderCellDef class="px-6 py-3 text-center text-xs font-medium text-gray-500 uppercase tracking-wider">
            Porcentaje
          </th>
          <td mat-cell *matCellDef="let detalle" class="px-6 py-4 whitespace-nowrap text-center">
            {{ detalle.porcentaje }}
          </td>
        </ng-container>
  
        <ng-container matColumnDef="estatus">
          <th mat-header-cell *matHeaderCellDef class="px-6 py-3 text-center text-xs font-medium text-gray-500 uppercase tracking-wider">
            Estado
          </th>
          <td mat-cell *matCellDef="let detalle" class="px-6 py-4 whitespace-nowrap text-center">
            <span [ngClass]="{
              'bg-green-100 text-green-800': detalle.estatus,
              'bg-red-100 text-red-800': !detalle.estatus
            }" class="px-2 inline-flex text-xs leading-5 font-semibold rounded-full">
              {{ detalle.estatus ? "Activo" : "Inactivo" }}
            </span>
          </td>
        </ng-container>
  
        <ng-container matColumnDef="acciones">
          <th mat-header-cell *matHeaderCellDef class="px-6 py-3 text-center text-xs font-medium text-gray-500 uppercase tracking-wider">
            Acciones
          </th>
          <td mat-cell *matCellDef="let materia" class="flex justify-center py-4 whitespace-nowrap text-center text-sm font-medium">
            <button
              class="mr-4 text-blue-400 hover:text-blue-800"
              matTooltip="Editar"
              (click)="editMateriaPrima(materia)"
            >
              <i class="fa-regular fa-pen-to-square fa-xl"></i>
            </button>
            <button
              *ngIf="materia.estatus"
              class="text-red-600 hover:text-red-800"
              matTooltip="Desactivar"
              (click)="deleteMateriaPrima(materia)"
            >
              <ion-icon class="size-6" name="trash-outline"></ion-icon>
            </button>
            <button
              *ngIf="!materia.estatus"
              class="text-green-600 hover:text-green-800"
              matTooltip="Activar"
              (click)="activateMateriaPrima(materia)"
            >
              <ion-icon class="size-6" name="checkmark-outline"></ion-icon>
            </button>
          </td>
        </ng-container>
  
        <tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>
        <tr mat-row *matRowDef="let row; columns: displayedColumns"></tr>
      </table>
      <mat-paginator [pageSizeOptions]="[5, 10, 25, 100]" showFirstLastButtons></mat-paginator>
    </div>
  </div>
  